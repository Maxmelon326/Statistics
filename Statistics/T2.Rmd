
Task 1

```{R}
#Q1 Define and print sting.

# Define the string
task_description <- "Name: LI WAN, Unit Name: SIT741, Task Name: T02.P1"

# Print the string
cat(task_description, "\n")


```
```{R}
#Q2&Q3
flight <- read.csv("https://raw.githubusercontent.com/hadley/nycflights13/master/data-raw/weather.csv", sep = ",")
# View the first few rows of the dataset
head(flight)


```

```{R}
#Q4
# Extract the number of observations (rows) and variables (columns)
num_observations <- nrow(flight)
num_variables <- ncol(flight)

# Print the results
cat("Number of observations (rows):", num_observations, "\n")
cat("Number of variables (columns):", num_variables, "\n")

```
```{r}
library(dplyr)
#Q5
flight1<-read.csv("https://raw.githubusercontent.com/hadley/nycflights13/master/data-raw/weather.csv", sep = ",")%>% 
  mutate(origin = factor(origin))
class(flight$origin)
class(flight1$origin)
```

```{r}
# Q6
# Choose columns
columns_to_summarize <- c("temp", "dewp", "humid", "wind_dir", "wind_speed", "wind_gust", "precip", "pressure", "visib")

#  Use across() to calculate median and mean
flight1 %>% 
  group_by(origin) %>% 
  summarise(across(all_of(columns_to_summarize), 
                   list(mean = ~ round(mean(.x, na.rm = TRUE),2), 
                        median = ~ round(median(.x, na.rm = TRUE),2)), 
                   .names = "{col}_{fn}"))
```
```{r}
#Q7
library(nycflights13)
#install.packages(nycflights)
data(package = "nycflights13")

airlines <- nycflights13::airlines
head(airlines)
flights <- nycflights13::flights
head(flights)
airports <- nycflights13::airports
head(airports)
planes <- nycflights13::planes
head(planes)
weather <- nycflights13::weather
head(weather)

```
```{r}
#library(dplyr)
# Merge the flights data with the airports data to get the origin latitude and longitude
flights_with_origin <- flights %>%
  left_join(airports, by = c("origin" = "faa")) %>%
  rename(o_lat = lat, o_lon = lon) %>%
  select(-name, -alt, -tz, -dst)

# Merge the result with the airports data again to get the destination latitude and longitude
flights_with_full_coords <- flights_with_origin %>%
  left_join(airports, by = c("dest" = "faa")) %>%
  rename(d_lat = lat, d_lon = lon) %>%
  select(-name, -alt, -tz, -dst)

# Display the first few rows to check the result
head(flights_with_full_coords)

```

Task 2

```{r}
weather_data <-read.csv("E:/2-学习/1-Deakin/24-T2/SIT741/Assignment/IDCJCM0035_086282.csv",header = TRUE)
head(weather_data)

```

We can see from the above data. The statistic.element is too messy which gives a lot different information. And it makes difficult for users to find valuable information. And we can see the statistic.element format is measure description, unit and for years 1970 to different years(This is shown in start year and end year). Therefore, we can display without "for years..."
The information shown in the table most are numeric and some of them are date. We can separate as two tables such as Date_data and Other_data. 
Then we can see each table has 12 month and annual. We can separate another two tables for each table. 
These month information display horizontal. Therefore, we can try to display information vertically by introducing column "Month". It can be easier to filter to find valuable information in each month. 
We are aiming to have 4 tables:Annual_data, date_of_data, Annual_other_data,other_data.


```{r}
library(tidyr)
#1. We want to separate the statistic.Element column
weather_data1 <- weather_data %>% 
  separate(col = Statistic.Element,
            into = c("Measure"),
            sep = " for ",
            fill = "right")
#weather_data1

# Filter data into two separate data frames based on whether Date measure
date_of_data <- weather_data1 %>%
  filter(grepl("Date of", Measure))

other_data <- weather_data1 %>%
  filter(!grepl("Date of", Measure))

```

```{r}
#We know there there are some blank data in annual, it is easier to calculate average mean in this stage.

months <- c("January", "February", "March", "April", "May", "June", "July", "August", "September", "October", "November", "December")

# Convert character columns to numeric and handle empty strings and non-standard missing values as NA
convert_to_numeric <- function(x) {
  as.numeric(as.character(x))
}

# Convert columns
other_data[months] <- lapply(other_data[months], convert_to_numeric)

# Convert empty strings and other non-standard missing values in the Annual column to NA
other_data$Annual <- ifelse(other_data$Annual == "" | other_data$Annual %in% c("NA", "N/A"), NA, as.numeric(as.character(other_data$Annual)))

# Calculate the average of the January to December columns for each row
monthly_means <- rowMeans(other_data[months], na.rm = TRUE)

# Identify the positions of NA values in the Annual column
na_indices <- is.na(other_data$Annual)

# Replace NA values in the Annual column with the calculated means and round to one decimal place
other_data$Annual[na_indices] <- round(monthly_means[na_indices], 1)
#other_data


# Separate data into annual and other data 
Annual_data <- date_of_data %>%
  select(Measure, Annual, Number.of.Years, Start.Year, End.Year)

date_of_data <- date_of_data %>%
  select(-Annual, -Number.of.Years, -Start.Year, -End.Year)


Annual_other_data <- other_data %>%
  select(Measure, Annual, Number.of.Years, Start.Year, End.Year)

other_data <- other_data %>%
  select(-Annual, -Number.of.Years, -Start.Year, -End.Year)

Annual_data
date_of_data
Annual_other_data
other_data

```

```{r}
#2. We want to build a new column called "Month" for data data and "Value" for other data.

date_of_data <- date_of_data %>% 
  gather(key = "Month", value = "Date", January:December) 
date_of_data

other_data <- other_data %>% 
  gather(key = "Month", value = "Value", January:December) 
other_data

```




```{r}
#Handle NA, we can check the processed data to choose way to handle NA.
#view(Annual_data)
#view(date_of_data)
#view(Annual_other_data)
#view(other_data)
```

```{r}
#Annual_data, Numbers of years are missing.
Annual_data$Start.Year <- as.numeric(Annual_data$Start.Year)
Annual_data$End.Year <- as.numeric(Annual_data$End.Year)

Annual_data$Number.of.Years <- ifelse(Annual_data$Number.of.Years == "N/A",
                                      Annual_data$End.Year - Annual_data$Start.Year,
                                      as.numeric(Annual_data$Number.of.Years))
Annual_data

```
```{r}
#Annual_other_data has n/a(Number.of.Years are 54) in Start.Year and End.Year. We can change Start.Year as 1970 and End.Year as 2024.

# Function to replace "n/a" and convert to numeric
replace_and_convert <- function(x, replacement) {
  x <- as.character(x)  # Ensure input is character
  x[x == "n/a"] <- replacement  # Replace "n/a" with replacement value
  as.numeric(x)  # Convert to numeric
}

# Replace "n/a" and convert columns to numeric
Annual_other_data <- Annual_other_data %>%
  mutate(
    Start.Year = replace_and_convert(Start.Year, 1970),
    End.Year = replace_and_convert(End.Year, 2024)
  )

```


```{r}
#check processed data

Annual_data
date_of_data
Annual_other_data
other_data



#view(Annual_data)
#view(date_of_data)
#view(Annual_other_data)
#view(other_data)

```
```{r}

# Save each data frame to a CSV file
write.csv(Annual_data, "E:/2-学习/1-Deakin/24-T2/SIT741/Assignment/Annual_data.csv", row.names = FALSE)
write.csv(date_of_data, "E:/2-学习/1-Deakin/24-T2/SIT741/Assignment/date_of_data.csv", row.names = FALSE)
write.csv(Annual_other_data, "E:/2-学习/1-Deakin/24-T2/SIT741/Assignment/Annual_other_data.csv", row.names = FALSE)
write.csv(other_data, "E:/2-学习/1-Deakin/24-T2/SIT741/Assignment/other_data.csv", row.names = FALSE)



```


